      subroutine dt4o_d(d1,o2,t5,dedt5o)

      implicit double precision(a-h,o-z)

      dimension d1(3),o2(3,3,3),t5(3,3,3,3,3),dedt5o(3)

c  this subroutine evaluates the quadrupole-quadrupole
c  electrostatic interaction

      dimension a(3,15),b(15)

      a(1,1)=t5(1,1,1,1,1)
      a(1,2)=t5(1,1,1,1,2)
      a(1,3)=t5(1,1,1,1,3)
      a(1,4)=t5(1,1,1,2,2)
      a(1,5)=t5(1,1,1,2,3)
      a(1,6)=t5(1,1,1,3,3)
      a(1,7)=t5(1,1,2,2,2)
      a(1,8)=t5(1,1,2,2,3)
      a(1,9)=t5(1,1,2,3,3)
      a(1,10)=t5(1,1,3,3,3)
      a(1,11)=t5(1,2,2,2,2)
      a(1,12)=t5(1,2,2,2,3)
      a(1,13)=t5(1,2,2,3,3)
      a(1,14)=t5(1,2,3,3,3)
      a(1,15)=t5(1,3,3,3,3)

      a(2,1)=t5(1,1,1,1,2)
      a(2,2)=t5(1,1,1,2,2)
      a(2,3)=t5(1,1,1,2,3)
      a(2,4)=t5(1,1,2,2,2)
      a(2,5)=t5(1,1,2,2,3)
      a(2,6)=t5(1,1,2,3,3)
      a(2,7)=t5(1,2,2,2,2)
      a(2,8)=t5(1,2,2,2,3)
      a(2,9)=t5(1,2,2,3,3)
      a(2,10)=t5(1,2,3,3,3)
      a(2,11)=t5(2,2,2,2,2)
      a(2,12)=t5(2,2,2,2,3)
      a(2,13)=t5(2,2,2,3,3)
      a(2,14)=t5(2,2,3,3,3)
      a(2,15)=t5(2,3,3,3,3)

      a(3,1)=t5(1,1,1,1,3)
      a(3,2)=t5(1,1,1,2,3)
      a(3,3)=t5(1,1,1,3,3)
      a(3,4)=t5(1,1,2,2,3)
      a(3,5)=t5(1,1,2,3,3)
      a(3,6)=t5(1,1,3,3,3)
      a(3,7)=t5(1,2,2,2,3)
      a(3,8)=t5(1,2,2,3,3)
      a(3,9)=t5(1,2,3,3,3)
      a(3,10)=t5(1,3,3,3,3)
      a(3,11)=t5(2,2,2,2,3)
      a(3,12)=t5(2,2,2,3,3)
      a(3,13)=t5(2,2,3,3,3)
      a(3,14)=t5(2,3,3,3,3)
      a(3,15)=t5(3,3,3,3,3)

      b(1)=d1(1)*o2(1,1,1)
      b(2)=3.d0*d1(1)*o2(1,1,2)+d1(2)*o2(1,1,1)
      b(3)=3.d0*d1(1)*o2(1,1,3)+d1(3)*o2(1,1,1)
      b(4)=3.d0*(d1(1)*o2(1,2,2)+d1(2)*o2(1,1,2))
      b(5)=6.d0*d1(1)*o2(1,2,3)+3.d0*(d1(2)*o2(1,1,3)+d1(3)*o2(1,1,2))
      b(6)=3.d0*(d1(1)*o2(1,3,3)+d1(3)*o2(1,1,3))
      b(7)=3.d0*d1(2)*o2(1,2,2)+d1(1)*o2(2,2,2)
      b(8)=6.d0*d1(2)*o2(1,2,3)+3.d0*(d1(1)*o2(2,2,3)+d1(3)*o2(1,2,2))
      b(9)=6.d0*d1(3)*o2(1,2,3)+3.d0*(d1(1)*o2(2,3,3)+d1(2)*o2(1,3,3))
      b(10)=3.d0*d1(3)*o2(1,3,3)+d1(1)*o2(3,3,3)
      b(11)=d1(2)*o2(2,2,2)
      b(12)=3.d0*d1(2)*o2(2,2,3)+d1(3)*o2(2,2,2)
      b(13)=3.d0*(d1(2)*o2(2,3,3)+d1(3)*o2(2,2,3))
      b(14)=3.d0*d1(3)*o2(2,3,3)+d1(2)*o2(3,3,3)
      b(15)=d1(3)*o2(3,3,3)

      dedt5o(1)=a(1,1)*b(1)+a(1,2)*b(2)+a(1,3)*b(3)+a(1,4)*b(4)+
     .      a(1,5)*b(5)+a(1,6)*b(6)+a(1,7)*b(7)+a(1,8)*b(8)+a(1,9)*b(9)+
     .      a(1,10)*b(10)+a(1,11)*b(11)+a(1,12)*b(12)+a(1,13)*b(13)+
     .      a(1,14)*b(14)+a(1,15)*b(15)

      dedt5o(2)=a(2,1)*b(1)+a(2,2)*b(2)+a(2,3)*b(3)+a(2,4)*b(4)+
     .      a(2,5)*b(5)+a(2,6)*b(6)+a(2,7)*b(7)+a(2,8)*b(8)+a(2,9)*b(9)+
     .      a(2,10)*b(10)+a(2,11)*b(11)+a(2,12)*b(12)+a(2,13)*b(13)+
     .      a(2,14)*b(14)+a(2,15)*b(15)

      dedt5o(3)=a(3,1)*b(1)+a(3,2)*b(2)+a(3,3)*b(3)+a(3,4)*b(4)+
     .      a(3,5)*b(5)+a(3,6)*b(6)+a(3,7)*b(7)+a(3,8)*b(8)+a(3,9)*b(9)+
     .      a(3,10)*b(10)+a(3,11)*b(11)+a(3,12)*b(12)+a(3,13)*b(13)+
     .      a(3,14)*b(14)+a(3,15)*b(15)

      return
      end

