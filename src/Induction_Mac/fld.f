      subroutine fld(irank,t1,t2,t3,t4,t5,c,d,q,o,h,fd)

      implicit double precision(a-h,o-z)

      dimension t1(3),t2(3,3),t3(3,3,3),t4(3,3,3,3),t5(3,3,3,3,3)

      dimension d(3),q(3,3),o(3,3,3),h(3,3,3,3),fd(3),f(15)

c  this subrrotine evaluate the electric field

      do k=1,3
       fd(k)=0.d0
      enddo

      if(irank.eq.4)go to 4
      if(irank.eq.3)go to 3
      if(irank.eq.2)go to 2
      if(irank.eq.1)go to 1
      if(irank.eq.0)go to 10

4     continue
c hexadecapole terms

      f(1)=h(1,1,1,1)
      f(2)=h(1,1,1,2)*4.d0
      f(3)=h(1,1,1,3)*4.d0
      f(4)=h(1,1,2,2)*6.d0
      f(5)=h(1,1,2,3)*12.d0
      f(6)=h(1,1,3,3)*6.d0
      f(7)=h(1,2,2,2)*4.d0
      f(8)=h(1,2,2,3)*12.d0
      f(9)=h(1,2,3,3)*12.d0
      f(10)=h(1,3,3,3)*4.d0
      f(11)=h(2,2,2,2)
      f(12)=h(2,2,2,3)*4.d0
      f(13)=h(2,2,3,3)*6.d0
      f(14)=h(2,3,3,3)*4.d0
      f(15)=h(3,3,3,3)

      fd(1)=fd(1)
     .     -t5(1,1,1,1,1)*f(1)
     .     -t5(1,1,1,1,2)*f(2)
     .     -t5(1,1,1,1,3)*f(3)
     .     -t5(1,1,1,2,2)*f(4)
     .     -t5(1,1,1,2,3)*f(5)
     .     -t5(1,1,1,3,3)*f(6)
     .     -t5(1,1,2,2,2)*f(7)
     .     -t5(1,1,2,2,3)*f(8)
     .     -t5(1,1,2,3,3)*f(9)
     .     -t5(1,1,3,3,3)*f(10)
     .     -t5(1,2,2,2,2)*f(11)
     .     -t5(1,2,2,2,3)*f(12)
     .     -t5(1,2,2,3,3)*f(13)
     .     -t5(1,2,3,3,3)*f(14)
     .     -t5(1,3,3,3,3)*f(15)


      fd(2)=fd(2)
     .     -t5(1,1,1,1,2)*f(1)
     .     -t5(1,1,1,2,2)*f(2)
     .     -t5(1,1,1,2,3)*f(3)
     .     -t5(1,1,2,2,2)*f(4)
     .     -t5(1,1,2,2,3)*f(5)
     .     -t5(1,1,2,3,3)*f(6)
     .     -t5(1,2,2,2,2)*f(7)
     .     -t5(1,2,2,2,3)*f(8)
     .     -t5(1,2,2,3,3)*f(9)
     .     -t5(1,2,3,3,3)*f(10)
     .     -t5(2,2,2,2,2)*f(11)
     .     -t5(2,2,2,2,3)*f(12)
     .     -t5(2,2,2,3,3)*f(13)
     .     -t5(2,2,3,3,3)*f(14)
     .     -t5(2,3,3,3,3)*f(15)


      fd(3)=fd(3)
     .     -t5(1,1,1,1,3)*f(1)
     .     -t5(1,1,1,2,3)*f(2)
     .     -t5(1,1,1,3,3)*f(3)
     .     -t5(1,1,2,2,3)*f(4)
     .     -t5(1,1,2,3,3)*f(5)
     .     -t5(1,1,3,3,3)*f(6)
     .     -t5(1,2,2,2,3)*f(7)
     .     -t5(1,2,2,3,3)*f(8)
     .     -t5(1,2,3,3,3)*f(9)
     .     -t5(1,3,3,3,3)*f(10)
     .     -t5(2,2,2,2,3)*f(11)
     .     -t5(2,2,2,3,3)*f(12)
     .     -t5(2,2,3,3,3)*f(13)
     .     -t5(2,3,3,3,3)*f(14)
     .     -t5(3,3,3,3,3)*f(15)

      do k=1,3
       fd(k)=fd(k)/105.d0
      enddo

3     continue

c  octapole terms

      f(1)=o(1,1,1)/15.d0
      f(2)=o(1,1,2)/5.d0
      f(3)=o(1,1,3)/5.d0
      f(4)=o(1,2,2)/5.d0
      f(5)=2.d0*o(1,2,3)/5.d0
      f(6)=o(1,3,3)/5.d0
      f(7)=o(2,2,2)/15.d0
      f(8)=o(2,2,3)/5.d0
      f(9)=o(2,3,3)/5.d0
      f(10)=o(3,3,3)/15.d0

      fd(1)=fd(1)
     .     +t4(1,1,1,1)*f(1)
     .     +t4(1,1,1,2)*f(2)
     .     +t4(1,1,1,3)*f(3)
     .     +t4(1,1,2,2)*f(4)
     .     +t4(1,1,2,3)*f(5)
     .     +t4(1,1,3,3)*f(6)
     .     +t4(1,2,2,2)*f(7)
     .     +t4(1,2,2,3)*f(8)
     .     +t4(1,2,3,3)*f(9)
     .     +t4(1,3,3,3)*f(10)

      fd(2)=fd(2)
     .     +t4(1,1,1,2)*f(1)
     .     +t4(1,1,2,2)*f(2)
     .     +t4(1,1,2,3)*f(3)
     .     +t4(1,2,2,2)*f(4)
     .     +t4(1,2,2,3)*f(5)
     .     +t4(1,2,3,3)*f(6)
     .     +t4(2,2,2,2)*f(7)
     .     +t4(2,2,2,3)*f(8)
     .     +t4(2,2,3,3)*f(9)
     .     +t4(2,3,3,3)*f(10)

      fd(3)=fd(3)
     .     +t4(1,1,1,3)*f(1)
     .     +t4(1,1,2,3)*f(2)
     .     +t4(1,1,3,3)*f(3)
     .     +t4(1,2,2,3)*f(4)
     .     +t4(1,2,3,3)*f(5)
     .     +t4(1,3,3,3)*f(6)
     .     +t4(2,2,2,3)*f(7)
     .     +t4(2,2,3,3)*f(8)
     .     +t4(2,3,3,3)*f(9)
     .     +t4(3,3,3,3)*f(10)

2     continue

c quadrupole terms

      f(1)=q(1,1)/3.d0
      f(2)=2.d0*q(1,2)/3.d0
      f(3)=2.d0*q(1,3)/3.d0
      f(4)=q(2,2)/3.d0
      f(5)=2.d0*q(2,3)/3.d0
      f(6)=q(3,3)/3.d0

      fd(1)=fd(1)
     .     -t3(1,1,1)*f(1)
     .     -t3(1,1,2)*f(2)
     .     -t3(1,1,3)*f(3)
     .     -t3(1,2,2)*f(4)
     .     -t3(1,2,3)*f(5)
     .     -t3(1,3,3)*f(6)

      fd(2)=fd(2)
     .     -t3(1,1,2)*f(1)
     .     -t3(1,2,2)*f(2)
     .     -t3(1,2,3)*f(3)
     .     -t3(2,2,2)*f(4)
     .     -t3(2,2,3)*f(5)
     .     -t3(2,3,3)*f(6)


      fd(3)=fd(3)
     .     -t3(1,1,3)*f(1)
     .     -t3(1,2,3)*f(2)
     .     -t3(1,3,3)*f(3)
     .     -t3(2,2,3)*f(4)
     .     -t3(2,3,3)*f(5)
     .     -t3(3,3,3)*f(6)

1     continue

c dipole terms

      fd(1)=fd(1)+t2(1,1)*d(1)+t2(1,2)*d(2)+t2(1,3)*d(3)
      fd(2)=fd(2)+t2(1,2)*d(1)+t2(2,2)*d(2)+t2(2,3)*d(3)
      fd(3)=fd(3)+t2(1,3)*d(1)+t2(2,3)*d(2)+t2(3,3)*d(3)

c  charge term
10    continue
      
      fd(1)=fd(1)-t1(1)*c
      fd(2)=fd(2)-t1(2)*c
      fd(3)=fd(3)-t1(3)*c

      return
      end
