      subroutine qt4q(q1,q2,t4,eqt4q)

      implicit double precision(a-h,o-z)

      dimension q1(3,3),q2(3,3),t4(3,3,3,3)

c  this subroutine evaluates the quadrupole-quadrupole
c  electrostatic interaction

      dimension a(15),b(15)

      a(1)=t4(1,1,1,1)
      a(2)=t4(1,1,1,2)
      a(3)=t4(1,1,1,3)
      a(4)=t4(1,1,2,2)
      a(5)=t4(1,1,2,3)
      a(6)=t4(1,1,3,3)
      a(7)=t4(1,2,2,2)
      a(8)=t4(1,2,2,3)
      a(9)=t4(1,2,3,3)
      a(10)=t4(1,3,3,3)
      a(11)=t4(2,2,2,2)
      a(12)=t4(2,2,2,3)
      a(13)=t4(2,2,3,3)
      a(14)=t4(2,3,3,3)
      a(15)=t4(3,3,3,3)

      b(1)=q1(1,1)*q2(1,1)
      b(2)=2.d0*(q1(1,2)*q2(1,1)+q1(1,1)*q2(1,2))
      b(3)=2.d0*(q1(1,3)*q2(1,1)+q1(1,1)*q2(1,3))
      b(4)=q1(2,2)*q2(1,1)+q1(1,1)*q2(2,2)+4.d0*q1(1,2)*q2(1,2)
      b(5)=2.d0*(q1(1,1)*q2(2,3)+q1(2,3)*q2(1,1)+2.d0*(
     . q1(1,2)*q2(1,3)+q1(1,3)*q2(1,2)))
      b(6)=q1(3,3)*q2(1,1)+q1(1,1)*q2(3,3)+4.d0*q1(1,3)*q2(1,3)
      b(7)=2.d0*(q1(1,2)*q2(2,2)+q1(2,2)*q2(1,2))
      b(8)=2.d0*(q1(1,3)*q2(2,2)+q1(2,2)*q2(1,3)+2.d0*(
     . q1(1,2)*q2(2,3)+q1(2,3)*q2(1,2)))
      b(9)=2.d0*(q1(1,2)*q2(3,3)+q1(3,3)*q2(1,2)+2.d0*(
     . q1(1,3)*q2(2,3)+q1(2,3)*q2(1,3)))
      b(10)=2.d0*(q1(1,3)*q2(3,3)+q1(3,3)*q2(1,3))
      b(11)=q1(2,2)*q2(2,2)
      b(12)=2.d0*(q1(2,3)*q2(2,2)+q1(2,2)*q2(2,3))
      b(13)=q1(2,2)*q2(3,3)+q1(3,3)*q2(2,2)+4.d0*q1(2,3)*q2(2,3)
      b(14)=2.d0*(q1(2,3)*q2(3,3)+q1(3,3)*q2(2,3))
      b(15)=q1(3,3)*q2(3,3)

      eqt4q=a(1)*b(1)+a(2)*b(2)+a(3)*b(3)+a(4)*b(4)+
     .      a(5)*b(5)+a(6)*b(6)+a(7)*b(7)+a(8)*b(8)+a(9)*b(9)+
     .      a(10)*b(10)+a(11)*b(11)+a(12)*b(12)+a(13)*b(13)+
     .      a(14)*b(14)+a(15)*b(15)

      return
      end

